#!/bin/bash

SCRIPTNAME=`echo $0 | awk -F/ '{print $NF}'`
mounted=`cat /proc/mounts | grep "/dev/sda3"`

if [[ $option == '-h' || $option == '-?' || $option == '--help' ]]; then
        cat ~/bin/.$SCRIPTNAME.help
        exit
fi

if (( $# == 0 )); then
	if [[ ! -d /media/tomek/Windows ]]; then
		option='-m'
	else
		option='-u'
	fi
else
	option=$1
fi

if [[ $option == '--short-info' ]]; then
	if [[ $mounted ]]; then
		echo 1
	else
		echo 0
	fi
	exit
fi

if [[ $option == '-i' || $option == '--info' ]]; then
        if [[ $mounted ]]; then
                echo 'Windows is mounted.

 Try:   windows [-u] to unmount.'
        else
                echo 'Windows is not mounted.

 Try:   windows [-m] to mount.'
        fi

        exit
fi

sudo echo -n

if [[ $option == '-m' ]]; then
	if [[ $mounted ]]; then
		echo "Error: Windows is already mounted. Exit code: 2"
		exit 2
	fi

	echo -n "Mounting Windows..."
	sudo mkdir /media/tomek/Windows
	sudo mount /dev/sda3 /media/tomek/Windows
	cd /media/tomek/Windows/Users/Tomek
	echo
	exit
fi

if [[ $option == '-u' ]]; then
	if [[ ! $mounted ]]; then
		echo "Error: Windows is not mounted. Unable to unmount. Exit code: 3"
		exit 3
	fi

	echo -n "Unmounting Windows..."
	sudo umount /media/tomek/Windows
	sudo rmdir /media/tomek/Windows
	echo
	exit
fi

echo "An error occurred. Exit code: 1"
exit 1
